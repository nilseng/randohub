(this.webpackJsonprandohub=this.webpackJsonprandohub||[]).push([[0],{108:function(e,t,a){},110:function(e,t,a){},111:function(e,t,a){},112:function(e,t,a){},133:function(e,t,a){},134:function(e,t,a){"use strict";a.r(t);var n=a(9),r=a.n(n),c=a(22),i=a(14),l=a(0),o=a.n(l),u=a(36),s=a.n(u),m=a(97),d=a(95),p=a(19),f=a(38),b=a(96);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var h=a(12),g=a(62),v=a(69),E=function(){return window.history.replaceState({},document.title,window.location.pathname)},j=o.a.createContext(),w=function(){return Object(l.useContext)(j)},O={domain:"randohub-dev.eu.auth0.com",client_id:"VjQM2BbtK1jV3jelvjoCbKVaM9mL2y4H"},y=function(){return new Promise(function(){var e=Object(i.a)(r.a.mark((function e(t,a){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=11;break}return e.prev=1,e.next=4,Object(v.a)(O);case 4:n=e.sent,t(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),a(new Error("getAuth0Client Error",e.t0));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,a){return e.apply(this,arguments)}}())},k=function(){var e=Object(i.a)(r.a.mark((function e(){var t,a=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:return t=e.sent,e.next=5,t.getIdTokenClaims.apply(t,a);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(e){var t=e.children,a=e.onRedirectCallback,n=void 0===a?E:a,c=Object(g.a)(e,["children","onRedirectCallback"]),u=Object(l.useState)(),s=Object(h.a)(u,2),m=s[0],d=s[1],p=Object(l.useState)(),f=Object(h.a)(p,2),b=f[0],w=f[1],O=Object(l.useState)(),y=Object(h.a)(O,2),k=y[0],x=y[1],I=Object(l.useState)(!0),T=Object(h.a)(I,2),S=T[0],_=T[1],N=Object(l.useState)(!1),C=Object(h.a)(N,2),R=C[0],$=C[1];Object(l.useEffect)((function(){(function(){var e=Object(i.a)(r.a.mark((function e(){var t,a,i,l,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.a)(c);case 2:if(t=e.sent,x(t),!window.location.search.includes("code=")||!window.location.search.includes("state=")){e.next=10;break}return e.next=7,t.handleRedirectCallback();case 7:a=e.sent,i=a.appState,n(i);case 10:return e.next=12,t.isAuthenticated();case 12:if(l=e.sent,d(l),!l){e.next=19;break}return e.next=17,t.getUser();case 17:o=e.sent,w(o);case 19:_(!1);case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);var L=function(){var e=Object(i.a)(r.a.mark((function e(){var t,a,n=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},$(!0),e.prev=2,e.next=5,k.loginWithPopup(t);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.error(e.t0);case 10:return e.prev=10,$(!1),e.finish(10);case 13:return e.next=15,k.getUser();case 15:a=e.sent,w(a),d(!0);case 18:case"end":return e.stop()}}),e,null,[[2,7,10,13]])})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Object(i.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _(!0),e.next=3,k.handleRedirectCallback();case 3:return e.next=5,k.getUser();case 5:t=e.sent,_(!1),d(!0),w(t);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return o.a.createElement(j.Provider,{value:{isAuthenticated:m,user:b,loading:S,popupOpen:R,loginWithPopup:L,handleRedirectCallback:M,getIdTokenClaims:function(){return k.getIdTokenClaims.apply(k,arguments)},loginWithRedirect:function(){return k.loginWithRedirect.apply(k,arguments)},getTokenSilently:function(){return k.getTokenSilently.apply(k,arguments)},getTokenWithPopup:function(){return k.getTokenWithPopup.apply(k,arguments)},logout:function(){return k.logout.apply(k,arguments)}}},t)},I=a(30),T=Object(I.a)(),S=a(137),_=function(e){var t=e.component,a=e.path,n=Object(g.a)(e,["component","path"]),c=w(),u=c.loading,s=c.isAuthenticated,m=c.loginWithRedirect;Object(l.useEffect)((function(){u||s||function(){var e=Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m({appState:{targetUrl:window.location.pathname}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[u,s,m,a]);return o.a.createElement(S.a,{path:a,render:function(e){return!0===s?o.a.createElement(t,Object.assign({},e,n)):null}})},N=a(52),C=a(31),R=a(32),$=a(17),L=a(18),M=(a(108),function(e){var t=e.setShowModal,a=w(),n=a.loading,r=a.isAuthenticated,c=a.loginWithRedirect,i=a.logout;return o.a.createElement(N.a,{bg:"dark",variant:"dark",expand:"md",collapseOnSelect:!0},o.a.createElement(N.a.Brand,{style:{color:"#f8f9fa"},href:"/"},o.a.createElement("span",{style:{backgroundColor:"#f8f9fa",padding:"0.4rem",borderRadius:"0.1rem",color:"black"}},o.a.createElement($.a,{icon:L.g,style:{marginRight:"0.4rem",color:"#343a40"}}),"Randohub")),o.a.createElement(N.a.Toggle,{className:"mb-2","aria-controls":"basic-navbar-nav",style:{outline:"none"}}),o.a.createElement(N.a.Collapse,{id:"basic-navbar-nav",className:"justify-content-end"},!n&&o.a.createElement(C.a,null,r&&o.a.createElement(C.a.Link,{className:"btn btn-outline-primary mr-2",onClick:function(){return t(!0)}},o.a.createElement($.a,{icon:L.i,className:"mr-2"}),"Legg til tur"),o.a.createElement(C.a.Link,{href:"/summits"},o.a.createElement($.a,{icon:L.g,style:{marginRight:"0.4rem"}}),"Topper"),!r&&o.a.createElement(C.a.Item,null,o.a.createElement(R.a,{variant:"link",className:"mr-2",onClick:function(){return c({})}},o.a.createElement($.a,{icon:L.d,style:{marginRight:"0.4rem"}}),"Logg inn")),r&&o.a.createElement(o.a.Fragment,null,o.a.createElement(C.a.Item,null,o.a.createElement(C.a.Link,{href:"/bucketlist"},o.a.createElement($.a,{icon:L.e,style:{marginRight:"0.4rem"}}),"\xd8nskelista")),o.a.createElement(C.a.Item,null,o.a.createElement(C.a.Link,{href:"/profile"},o.a.createElement($.a,{icon:L.j,style:{marginRight:"0.4rem"}}),"Profil")),o.a.createElement(C.a.Link,{className:"mr-2",onClick:function(){return i()}},o.a.createElement($.a,{icon:L.a,style:{marginRight:"0.4rem"}}),"Logg ut")))))}),B=function(){var e=w(),t=e.loading,a=e.user;return t||!a?o.a.createElement("div",null,"Loading..."):o.a.createElement(o.a.Fragment,null,o.a.createElement("img",{src:a.picture,alt:"Profile"}),o.a.createElement("h2",null,a.name),o.a.createElement("p",null,a.email),o.a.createElement("code",null,JSON.stringify(a,null,2)))},A=a(41),D=a(61),U=a(42),W=a.n(U),z=a(138),F=a(39),P=(a(110),a(111),function(e){var t=e.text;return o.a.createElement("div",{className:"preview-image-placeholder"},o.a.createElement($.a,{icon:L.c,size:"10x",className:"text-muted"}),t&&o.a.createElement("p",{className:"text-muted"},t))}),V=function(e){var t,a=e.trip,n=e.setTripToEdit,u=e.setShowModal,s=w().user,m=Object(l.useState)(),d=Object(h.a)(m,2),p=d[0],f=d[1],b=Object(l.useState)(new Date(+(null===a||void 0===a?void 0:a.createdAt)).toLocaleString(void 0,{year:"numeric",month:"numeric",day:"numeric"})),g=Object(h.a)(b,1)[0];Object(l.useEffect)((function(){var e;(null===(e=a.images)||void 0===e?void 0:e.length)>0&&fetch("/s3/object/".concat(a.images[0]._id)).then(function(){var e=Object(i.a)(r.a.mark((function e(t){var a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.blob();case 2:a=e.sent,n=URL.createObjectURL(a),f(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[a.images]);return o.a.createElement(F.a,{className:"card my-1",bg:"dark"},o.a.createElement("div",{className:"p-1"},o.a.createElement("div",{className:"d-flex justify-content-between"},o.a.createElement("div",null,g&&o.a.createElement("p",{className:"small mb-0"},g),(null===(t=a.createdBy)||void 0===t?void 0:t.name)&&o.a.createElement("p",{className:"small text-muted"},a.createdBy.name)),s&&s.sub===a.createdBy.sub&&o.a.createElement(R.a,{variant:"link",onClick:function(){n(Object(c.a)(Object(c.a)({},a),{},{imageIds:a.images.map((function(e){return e._id}))})),u(!0)}},o.a.createElement($.a,{icon:L.h,className:"text-muted"}))),a.name&&o.a.createElement(F.a.Title,{className:"mb-0"},a.name)),o.a.createElement("div",{className:"card-image-container"},p?o.a.createElement(F.a.Img,{src:p,className:"card-image rounded-0 pb-2"}):o.a.createElement(P,null)),a.description&&o.a.createElement("p",{className:"text-muted"},a.description))},H=a(48),Q=a(27),q=a(94),G=a(64);a(112);function J(){var e=Object(A.a)(["\n  mutation createImage($tripId: ID) {\n    createImage(tripId: $tripId) {\n      _id\n    }\n  }\n"]);return J=function(){return e},e}var K=W()(J()),Y=function(e){var t=e.trip,a=e.setTrip,n=e.defaultTrip,u=e.showModal,s=e.setShowModal,m=e.createTrip,d=e.updateTrip,p=e.deleteTrip,f=Object(l.useState)(),b=Object(h.a)(f,2),g=b[0],v=b[1],E=function(){var e=Object(i.a)(r.a.mark((function e(){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t._id){e.next=5;break}return e.next=3,m({variables:t});case 3:n=e.sent,a(Object(c.a)(Object(c.a)({},t),{},{_id:n.data.createTrip._id}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(){var e=Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:return e.next=4,d({variables:t});case 4:O();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t._id){e.next=3;break}return e.next=3,p({variables:{_id:t._id}});case 3:O();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(){a(n),s(!1),v()},y=function(){var e=Object(i.a)(r.a.mark((function e(){var a,n,c,i,l,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=new FormData,!g){e.next=21;break}n=0,c=Array.from(g);case 3:if(!(n<c.length)){e.next=14;break}return i=c[n],a.append("images",i),e.next=8,I({variables:{tripId:t._id}});case 8:l=e.sent,t.imageIds.push(l.data.createImage._id),a.append("imageIds",l.data.createImage._id);case 11:n++,e.next=3;break;case 14:return e.next=16,k();case 16:if(o=e.sent){e.next=19;break}return e.abrupt("return");case 19:return e.next=21,fetch("/s3/object",{headers:{authorization:"Bearer ".concat(o.__raw)},method:"POST",body:a});case 21:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=Object(z.a)(K),I=Object(h.a)(x,1)[0];return u&&t?o.a.createElement(H.a,{show:u,onHide:O,onShow:E},o.a.createElement(H.a.Header,null,o.a.createElement(H.a.Title,{className:"w-100"},o.a.createElement(Q.a.Group,null,o.a.createElement(Q.a.Label,null,"Navn p\xe5 turen"),o.a.createElement(Q.a.Control,{value:t.name,onChange:function(e){return a(Object(c.a)(Object(c.a)({},t),{},{name:e.target.value}))}})))),o.a.createElement(H.a.Body,null,o.a.createElement("div",{className:"image-container"},(null===g||void 0===g?void 0:g.length)>0&&o.a.createElement(G.a,{className:"h-100"},g.map((function(e){return o.a.createElement(G.a.Item,{key:e.name},o.a.createElement(q.a,{className:"preview-image",src:URL.createObjectURL(e),rounded:!0}),o.a.createElement(G.a.Caption,null,o.a.createElement("p",null,g.length," bilde(r) er valgt.")))}))),(!g||0===(null===g||void 0===g?void 0:g.length))&&o.a.createElement(P,{text:"Ingen bilder er valgt."})),o.a.createElement(Q.a.Group,{className:"mt-2"},o.a.createElement(Q.a.File,{custom:!0},o.a.createElement(Q.a.File.Input,{multiple:!0,accept:"image/*",onChange:function(e){return function(e){v(Array.from(e))}(e.target.files)}}),o.a.createElement(Q.a.File.Label,{"data-browse":"Velg bilder"},"Last opp bilder fra turen!"))),o.a.createElement(Q.a.Group,null,o.a.createElement(Q.a.Label,null,"Beskrivelse"),o.a.createElement(Q.a.Control,{value:t.description,onChange:function(e){return a(Object(c.a)(Object(c.a)({},t),{},{description:e.target.value}))},placeholder:"Hvordan var turen?",as:"textarea",rows:3}))),o.a.createElement(H.a.Footer,null,o.a.createElement(R.a,{variant:"secondary",onClick:function(){return w()}},"Forkast",o.a.createElement($.a,{icon:L.k,className:"ml-1"})),o.a.createElement(R.a,{onClick:function(){return j()}},"Lagre",o.a.createElement($.a,{icon:L.b,className:"ml-1"})))):null};function Z(){var e=Object(A.a)(["\n  mutation DeleteTrip($_id: ID!) {\n    deleteTrip(_id: $_id)\n  }\n"]);return Z=function(){return e},e}function X(){var e=Object(A.a)(["\n  mutation UpdateTrip(\n    $_id: ID!\n    $name: String\n    $description: String\n    $summitIds: [ID]\n    $imageIds: [ID]\n  ) {\n    updateTrip(\n      _id: $_id\n      name: $name\n      description: $description\n      summitIds: $summitIds\n      imageIds: $imageIds\n    ) {\n      _id\n      name\n      description\n      createdAt\n      images {\n        _id\n      }\n      createdBy {\n        sub\n        name\n      }\n    }\n  }\n"]);return X=function(){return e},e}function ee(){var e=Object(A.a)(["\n  mutation CreateTrip(\n    $name: String\n    $description: String\n    $summitIds: [ID]\n    $imageIds: [ID]\n  ) {\n    createTrip(\n      name: $name\n      description: $description\n      summitIds: $summitIds\n      imageIds: $imageIds\n    ) {\n      _id\n      name\n      description\n      createdAt\n      images {\n        _id\n      }\n      createdBy {\n        sub\n        name\n      }\n    }\n  }\n"]);return ee=function(){return e},e}function te(){var e=Object(A.a)(["\n  {\n    trips {\n      _id\n      name\n      description\n      createdAt\n      images {\n        _id\n      }\n      createdBy {\n        sub\n        name\n      }\n    }\n  }\n"]);return te=function(){return e},e}var ae=W()(te()),ne=W()(ee()),re=W()(X()),ce=W()(Z()),ie=function(e){var t=e.trip,a=e.setTrip,n=e.defaultTrip,r=e.showModal,c=e.setShowModal,i=Object(z.b)(ae),l=i.loading,u=i.error,s=i.data;u&&console.log(u);var m=Object(z.a)(ne,{update:function(e,t){var a=t.data.createTrip,n=e.readQuery({query:ae}).trips;n.unshift(a),e.writeQuery({query:ae,data:{trips:n}})}}),d=Object(h.a)(m,1)[0],p=Object(z.a)(re,{update:function(e,t){var a=t.data.updateTrip,n=e.readQuery({query:ae}).trips;(n=n.filter((function(e){return e._id!==a._id}))).unshift(a),e.writeQuery({query:ae,data:{trips:n}})}}),f=Object(h.a)(p,1)[0],b=Object(z.a)(ce,{update:function(e,t){var a=t.data.deleteTrip,n=e.readQuery({query:ae}).trips;n=n.filter((function(e){return e._id!==a})),e.writeQuery({query:ae,data:{trips:n}})}}),g=Object(h.a)(b,1)[0];return o.a.createElement(D.a,{className:"py-4 px-0"},o.a.createElement(Y,{trip:t,setTrip:a,defaultTrip:n,showModal:r,setShowModal:c,createTrip:d,updateTrip:f,deleteTrip:g}),l&&o.a.createElement("div",null,"loading..."),s&&s.trips.map((function(e){return o.a.createElement(V,{key:e._id,trip:e,setTripToEdit:a,setShowModal:c})})))},le=function(){var e=Object(S.d)();return o.a.createElement("div",{style:{width:"100vw",minHeight:"100vh",backgroundColor:"black"}},o.a.createElement(D.a,{style:{padding:"1rem 0"}},o.a.createElement(F.a,{style:{padding:"1rem",margin:"1rem 0",width:"27rem",maxWidth:"100%",color:"#f8f9fa"},bg:"dark"},o.a.createElement(F.a.Title,null,"H\xf8gdebrotet"),o.a.createElement(F.a.Body,null,o.a.createElement("div",null,"2226 moh.")),o.a.createElement(R.a,{onClick:function(){return e.push("/map")}},o.a.createElement($.a,{icon:L.f,className:"mr-2"}),"Se kart"))))},oe=function(){return o.a.createElement("ul",null,o.a.createElement("li",null,"Galdh\xf8piggen 2469"),o.a.createElement("li",null,"Denali 6190"),o.a.createElement("li",null,"K2 8611"))},ue=a(73),se=a.n(ue),me=function(){se.a.accessToken="pk.eyJ1Ijoibmlsc2VuZyIsImEiOiJja2lyYmZoNnoyNHRoMnlxam42M2FhYTRzIn0.bNB_zGEjaXfrs-4cfz6V6w";var e=Object(l.useState)({lng:8.739,lat:61.448,zoom:12}),t=Object(h.a)(e,1)[0],a=Object(l.useRef)();return Object(l.useEffect)((function(){a&&new se.a.Map({container:a.current,style:"mapbox://styles/nilseng/ckiuk1uf02ykx19szgx4psp19",center:[t.lng,t.lat],zoom:t.zoom})}),[a,t]),o.a.createElement("div",{ref:a,id:"map",className:"vw-100",style:{position:"relative",height:"calc(100vh - 58px)",top:0,right:0,left:0,bottom:0}})},de={_id:null,name:"Topptur",description:"",summitIds:null,imageIds:[]},pe=function(){var e=w(),t=e.getTokenSilently,a=e.loading,n=Object(l.useState)(),c=Object(h.a)(n,2),u=c[0],s=c[1],m=Object(l.useState)(de),d=Object(h.a)(m,2),p=d[0],f=d[1],b=Object(l.useState)(!1),g=Object(h.a)(b,2),v=g[0],E=g[1];return Object(l.useEffect)((function(){a||function(){var e=Object(i.a)(r.a.mark((function e(){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:if(a=e.sent)try{localStorage.setItem("token",a)}catch(n){console.log("Could not set item in localStorage: ".concat(n))}case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[a,t,u,s]),o.a.createElement(o.a.Fragment,null,o.a.createElement(S.b,{history:T},o.a.createElement("header",null,o.a.createElement(M,{setShowModal:E})),o.a.createElement(S.c,null,o.a.createElement(S.a,{path:"/",exact:!0,render:function(e){return o.a.createElement(ie,{trip:p,setTrip:f,defaultTrip:de,setShowModal:E,showModal:v})}}),o.a.createElement(S.a,{path:"/summits",component:le}),o.a.createElement(_,{path:"/profile",component:B}),o.a.createElement(_,{path:"/bucketlist",component:oe}),o.a.createElement(S.a,{path:"/map",component:me}))))},fe=(a(132),a(133),Object(m.a)({credentials:"include"})),be=Object(d.a)(function(){var e=Object(i.a)(r.a.mark((function e(t,a){var n,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.headers,e.next=3,k();case 3:return i=e.sent,e.abrupt("return",{headers:Object(c.a)(Object(c.a)({},n),{},{authorization:i?"Bearer ".concat(i.__raw):""})});case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),he=new f.a({link:be.concat(fe),cache:new b.a});s.a.render(o.a.createElement(x,{domain:"randohub-dev.eu.auth0.com",client_id:"VjQM2BbtK1jV3jelvjoCbKVaM9mL2y4H",redirect_uri:window.location.origin,onRedirectCallback:function(e){T.push(e&&e.targetUrl?e.targetUrl:window.location.pathname)}},o.a.createElement(p.a,{client:he},o.a.createElement(pe,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[134,1,2]]]);
//# sourceMappingURL=main.71c120bb.chunk.js.map